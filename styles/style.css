@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@600&display=swap');
@import url('https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap');

/*─────────────────────────────────────────────────────────────────────────────
 Guide for new readers (what this file does)
─────────────────────────────────────────────────────────────────────────────*/
/*
  • This stylesheet formats FoundryVTT OBSUtils overlays for each character “card”.
  • Each card is `.actor` and contains rows called `.single-line-overlay` in order:
      #1 Portrait, #2 Nameplate, #3 HP, #4 AC, #5 Race/Class,
      #6 Physical (STR/DEX/CON), #7 Mental (INT/WIS/CHA)
  • Rows are absolutely positioned so we can pin them precisely (left/right/top/bottom).
  • Pseudo‑elements:
      ::before  → backgrounds/gradients/wood textures (visual only, no layout)
      ::after   → decorative frames/borders (visual only, no layout)
  • z-index controls stacking: larger z-index draws on top (e.g., nameplate > HP/AC > portrait).
  • Edit values in :root below to tweak sizes/colors without hunting numbers.
*/

/*─────────────────────────────────────────────────────────────────────────────
 :root — shared variables
─────────────────────────────────────────────────────────────────────────────*/
:root{
  /* Dimensions */
  --card-width: 220px;
  --card-height: 320px;
  --radius-card: 10px;

  /* Colors */
  --card-bg: #a58e57;

  /* Layout constants */
  --bar-height: 28px;
  --stack-height: 26px;
  --inset-x: 8px;
  --nameplate-height: 38px;
  --initial-card-left-placement: 0px;
  --card-placement-offset: 258px; 

  /* Typography */
    /* Font Family Information */
    --nameplate-font-family: 'UnifrakturCook', cursive !important;
    --nameplate-font-weight: 700 !important;

    /* Font Size Information */
    --nameplate-text-size: 18px !important;
    --pill-text-size: 18px !important;
    --stat-text-size: 16px !important;

    /* Font Color Information */
    --unified-font-color: #ffffff !important;
    --nameplate-font-color: var(--unified-font-color) !important;
    --hp-font-color: var(--unified-font-color) !important;
    --ac-font-color: var(--unified-font-color) !important;
    --physical-stats-font-color: var(--unified-font-color) !important;
    --mental-stats-font-color: var(--unified-font-color) !important;

  /* Nameplate (knotty wood) colors */
  --name-wood-1: #9a6a3a !important;  /* base stripes */
  --name-wood-2: #b37a41 !important;  /* secondary stripes */
  --name-wood-3: #865c33 !important;  /* tertiary stripes */

  /* Wood borders */
  --wood-dark: #6b4e2e !important; /* Used for the parts of the gradient of the border */
  --wood-mid:  #8a653b !important; /* Used for the parts of the gradient of the border */
  --wood-lite: #b48853 !important; /* Used for the parts of the gradient of the border */
  --wood-thick: 3px !important;

  /* Adjustables */
  --phys-raise: 8px !important;   /* how much Overlay #5 is raised above one bar */
  --pill-extend: 8px !important;  /* extra gold “foot” below HP/AC pills to cover seams */

  /* Gradient behind portrait */
  --portrait-gradient-lower-left: #b6e1ff;
  --portrait-gradient-upper-right: #f4f5f7;
}

/*─────────────────────────────────────────────────────────────────────────────
 1) BASE STYLES: BODY & CARD CONTAINER
─────────────────────────────────────────────────────────────────────────────*/
body {
  background-color: rgba(0, 0, 0, 0);  /* Transparent so only cards show */
  margin: 0 auto;
  overflow: hidden;                    /* Hide scrollbars in OBS */
}

.actor {
  position: absolute;                  /* Side-by-side placement */
  width: var(--card-width) !important;     /* Card width */
  height: var(--card-height) !important;    /* Card height */
  background-color: var(--card-bg) !important; /* Gold background */
  border-radius: var(--radius-card) !important; /* Rounded corners */
  overflow: hidden !important;         /* Clip child overlays */
  box-sizing: border-box;              /* Include padding/borders */
}

/* Horizontal placement for each card */
.actor:nth-child(1) { left: var(--initial-card-left-placement);}
.actor:nth-child(2) { left: calc(var(--initial-card-left-placement) + var(--card-placement-offset));}
.actor:nth-child(3) { left: calc(var(--initial-card-left-placement) + (var(--card-placement-offset) * 2));}
.actor:nth-child(4) { left: calc(var(--initial-card-left-placement) + (var(--card-placement-offset) * 3));}
.actor:nth-child(5) { left: calc(var(--initial-card-left-placement) + (var(--card-placement-offset) * 4));}

/*─────────────────────────────────────────────────────────────────────────────
 2) OVERLAY RESET
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay {
  margin: 0 !important;    /* Remove default margins */
  width: auto !important;  /* We size each overlay below */
  box-sizing: border-box;
}

/*─────────────────────────────────────────────────────────────────────────────
 4) OVERLAY #1 — CHARACTER NAME (knotty wood plaque, engraved text)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(1) {
  position: absolute !important;
  margin: auto;
  top: 0 !important;                    /* Pin to very top of card */
  width: 100% !important;
  display: flex !important;
  justify-content: center;
  align-items: center !important;
  gap: 4px !important;
  padding: 4px 6px !important;
  background-color: transparent !important; /* wood is on ::before */
  z-index: 5 !important;                 /* Above everything else */
  isolation: isolate;                     /* keep ::before behind text */
}
.actor .single-line-overlay:nth-child(1)::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius: var(--radius-card) var(--radius-card) 0 0;
  /* LAYER ORDER: (top) sheen → knots → grain stripes (bottom) */
  background:
    /* subtle sheen */
    linear-gradient(180deg, rgba(255,255,255,.10) 0%, rgba(0,0,0,.18) 80%),
    /* knots */
    repeating-radial-gradient(ellipse at 22% 65%, rgba(0,0,0,.22) 0 2px, rgba(0,0,0,0) 2px 7px),
    repeating-radial-gradient(ellipse at 68% 45%, rgba(0,0,0,.20) 0 2px, rgba(0,0,0,0) 2px 7px),
    repeating-radial-gradient(ellipse at 85% 78%, rgba(0,0,0,.18) 0 2px, rgba(0,0,0,0) 2px 7px),
    /* base striped grain */
    repeating-linear-gradient(12deg,
      var(--name-wood-1) 0 8px,
      var(--name-wood-2) 8px 16px,
      var(--name-wood-3) 16px 24px);
  background-blend-mode: overlay, multiply, multiply, multiply, normal;
  /* inset edges to sell the plank */
  box-shadow: inset 0 1px 0 rgba(255,255,255,.35), inset 0 -2px 0 rgba(0,0,0,.25);
  pointer-events:none;
  z-index:0;
}
/* Engraved text styling */
.actor .single-line-overlay:nth-child(1),
.actor .single-line-overlay:nth-child(1) .component{
  font-family: var(--nameplate-font-family) !important;
  font-weight: var(--nameplate-font-weight) !important;
  font-size: var(--nameplate-text-size);
  color: var(--nameplate-font-color) !important;
  letter-spacing: .3px;
  position: relative;
  z-index: 1;
  text-shadow: -1px -1px 0 rgba(0,0,0,.45), 1px 1px 0 rgba(255,255,255,.35);
  -webkit-text-stroke: 2px rgba(0,0,0,.28); /* Outline around light text to keep it readable on wood */
}

/*─────────────────────────────────────────────────────────────────────────────
 3) OVERLAY #2 — PORTRAIT IMAGE (below the name bar)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(2) {
  position: absolute !important;
  top: var(--nameplate-height) !important;    /* Portrait sits directly under the nameplate. If you change the nameplate height, this keeps the portrait aligned. */
  left: 0; right: 0;
  bottom: calc(var(--bar-height) * 2) !important; /* Leave space for two bottom rows (#6 and #7). Using bar-height so this scales with your rows. */
  background-size: cover !important;
  background-position: center !important;
  border-radius: var(--radius-card) var(--radius-card) 0 0 !important; /* top corners */
  z-index: 1 !important;               /* Behind stats & bars */
  padding: 0 !important;
}
/* Remove/override any old gradient on overlay #1 */
.actor .single-line-overlay:nth-child(2)::before { content: none !important; }

/* Card gradient sized to portrait region */
.actor::before {
  content: "";
  position: absolute;
  left: 0; right: 0;
  top: var(--bar-height);                   /* Start gradient one bar below the card top; visually matches the nameplate height so the gradient doesn't peek above it. */
  bottom: calc(var(--bar-height) * 2);      /* stops above the bottom rows */
  background: linear-gradient(to top right, var(--portrait-gradient-lower-left) 0%, var(--portrait-gradient-upper-right) 100%);
  border-radius: var(--radius-card) var(--radius-card) 0 0;  /* match card's top corners */
  pointer-events: none;
  z-index: 0;                          /* behind overlays, above card bg */
}

/* Ensure the portrait paints above the gradient */
.actor .single-line-overlay:nth-child(2) { z-index: 1 !important; }



/*─────────────────────────────────────────────────────────────────────────────
 5) OVERLAY #3 — HIT POINTS (pill, with optional foot; wood frame on 3 sides)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(3) {
  position: absolute !important;
  bottom: calc(var(--stack-height) * 3) !important; /* Position this pill three stacked-rows above the bottom so it lines up above rows #6 and #7 plus the race/class row. */
  left: var(--inset-x) !important;     /* Align left */
  display: flex !important;
  flex-direction: row !important; 
  align-items: center !important;
  gap: 4px !important;
  padding: 2px 4px !important;
  background-color: var(--card-bg) !important;
  font-size: var(--pill-text-size) !important;
  color: var(--hp-font-color);
  border-radius: 6px, 0px, 0px, 6px !important; /* Keeping original comma-separated syntax to match your source. Note: commas are not required in CSS for border-radius; most browsers ignore them. */
  width: max-content !important;
  white-space: nowrap !important;
  z-index: 4 !important;                /* Above portrait */
}
/* extend the gold bg below the pill (optional foot) */
.actor .single-line-overlay:nth-child(3)::before{
  content: "";
  position: absolute;
  left: 0; right: 0;
  bottom: calc(-1 * var(--pill-extend));
  height: var(--pill-extend);
  background: var(--card-bg);
  pointer-events: none;
  z-index: 0;
}
.actor .single-line-overlay:nth-child(3) .component {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  padding: 0 !important;
  white-space: nowrap !important;
}
/* wood frame (left/top/right only) */
.actor .single-line-overlay:nth-child(3)::after{
  content:"";
  position:absolute;
  top:  calc(-1 * var(--wood-thick));
  left: calc(-1 * var(--wood-thick));
  right:calc(-1 * var(--wood-thick));
  bottom:calc(-1 * var(--wood-thick));
  border-style: solid;
  border-width: var(--wood-thick) var(--wood-thick) 0 var(--wood-thick);
  border-color: var(--wood-mid);
  border-radius: 8px 8px 0 0;
  pointer-events:none;
  z-index: 1;
}

/*─────────────────────────────────────────────────────────────────────────────
 6) OVERLAY #4 — ARMOUR CLASS (pill, with foot; wood frame on 3 sides)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(4) {
  position: absolute !important;
  bottom: calc(var(--stack-height) * 3) !important; /* Position this pill three stacked-rows above the bottom so it lines up above rows #6 and #7 plus the race/class row. */
  right: var(--inset-x) !important;    /* Align right */
  display: flex !important;
  flex-direction: row !important;
  align-items: center !important;
  gap: 5px !important;
  padding: 4px 6px !important;
  background-color: var(--card-bg) !important;
  font-size: var(--pill-text-size) !important;
  color: var(--ac-font-color);
  border-radius: 6px, 0px, 0px, 6px !important; /* Keeping original comma-separated syntax to match your source. Note: commas are not required in CSS for border-radius; most browsers ignore them. */
  width: max-content !important;
  white-space: nowrap !important;
  overflow: visible !important;        /* let the foot render outside */
  z-index: 5 !important;
}
/* extend the gold bg below the pill without changing the wood border */
.actor .single-line-overlay:nth-child(4)::before{
  content: "";
  position: absolute;
  left: 0; right: 0;
  bottom: calc(-1 * var(--pill-extend));
  height: var(--pill-extend);
  background: var(--card-bg);
  pointer-events: none;
  z-index: 0;
}
.actor .single-line-overlay:nth-child(4) .component {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  padding: 0 !important;
  white-space: nowrap !important;
}
/* wood frame (left/top/right only) */
.actor .single-line-overlay:nth-child(4)::after{
  content:"";
  position:absolute;
  top:  calc(-1 * var(--wood-thick));
  left: calc(-1 * var(--wood-thick));
  right:calc(-1 * var(--wood-thick));
  bottom:calc(-1 * var(--wood-thick));
  border-style: solid;
  border-width: var(--wood-thick) var(--wood-thick) 0 var(--wood-thick);
  border-color: var(--wood-mid);
  border-radius: 8px 8px 0 0;
  pointer-events:none;
  z-index: 1;
}

/*─────────────────────────────────────────────────────────────────────────────
7) OVERLAY #5 — PHYSICAL ABILITIES (STR/DEX/CON) + wood top cap
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(5) {
  position: absolute !important;
  bottom: calc(var(--bar-height) + var(--phys-raise)) !important; /* One standard bar up from the bottom, plus a small extra raise to cover the portrait gradient seam and clear wood cap. */
  left: 0 !important;
  width: 100% !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 4px 6px !important;
  background-color: var(--card-bg) !important; /* cover gradient */
  font-size: var(--stat-text-size);
  color: var(--physical-stats-font-color);
  box-sizing: border-box;
  z-index: 2 !important;
}
.actor .single-line-overlay:nth-child(5) .component { 
  white-space: nowrap !important; 
  margin-right: 8px !important; }
/* top wood cap outside the row */
.actor .single-line-overlay:nth-child(5)::after{
  content:"";
  position:absolute;
  left: calc(-1 * var(--wood-thick));
  right: calc(-1 * var(--wood-thick));
  top: calc(-1 * var(--wood-thick));   /* sits just outside the box */
  height: calc(var(--wood-thick) * 2); /* chunky top strip */
  background: linear-gradient(90deg, var(--wood-dark), var(--wood-mid) 40%, var(--wood-lite) 60%, var(--wood-dark));
  border-radius: 6px 6px 0 0;
  pointer-events:none;
  z-index: 3; /* above row content */
}

/*─────────────────────────────────────────────────────────────────────────────
 8) OVERLAY #6 — MENTAL ABILITIES (INT/WIS/CHA)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(6) {
  position: absolute !important;
  bottom: 0 !important;                /* Flush with bottom */
  left: 0 !important;
  width: 100% !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 4px 6px !important;
  background-color: transparent !important;
  font-size: var(--stat-text-size);
  color: var(--mental-stats-font-color);
  box-sizing: border-box;
  z-index: 2 !important;
}
.actor .single-line-overlay:nth-child(6) .component { white-space: nowrap !important; margin-right: 8px !important; }

/*─────────────────────────────────────────────────────────────────────────────
 9) HIDE ANY EXTRA OVERLAYS
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(n+8) { display: none !important; }

/*─────────────────────────────────────────────────────────────────────────────
 10) STACKING CONTEXT FIXES
    - Push portrait behind all
    - Pull name bar to very top
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(1) { z-index: 9999 !important; }
.actor .single-line-overlay:nth-child(2) { z-index: 0 !important; }
.actor .single-line-overlay:nth-child(2) .component,
.actor .single-line-overlay:nth-child(2) .component img { position: relative !important; z-index: 0 !important; }