@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@600&display=swap');
@import url('https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap');

/*─────────────────────────────────────────────────────────────────────────────
 :root — shared variables
─────────────────────────────────────────────────────────────────────────────*/
:root{
  /* Dimensions */
  --card-width: 220px;
  --card-height: 320px;
  --radius-card: 10px;

  /* Colors */
  --card-bg: #a58e57;

  /* Layout Variables */
  --cards-top: 10px;
  --bar-height: 28px;
  --stack-height: 26px;
  --inset-x: 8px;
  --nameplate-height: 38px;
  --initial-card-left-placement: 0px;
  --card-placement-offset: 258px;
  --gradient-gap: 48px;

  /* Typography */
    /* Font Family Information */
    --nameplate-font-family: 'UnifrakturCook', cursive !important;
    --nameplate-font-weight: 700 !important;

    /* Font Size Information */
    --nameplate-text-size: 18px !important;
    --pill-text-size: 18px !important;
    --stat-text-size: 16px !important;

    /* Font Color Information */
    --unified-font-color: #ffffff !important;
    --nameplate-font-color: var(--unified-font-color) !important;
    --hp-font-color: var(--unified-font-color) !important;
    --ac-font-color: var(--unified-font-color) !important;
    --physical-stats-font-color: var(--unified-font-color) !important;
    --mental-stats-font-color: var(--unified-font-color) !important;

  /* Nameplate (knotty wood) colors */
  --name-wood-1: #9a6a3a !important;
  --name-wood-2: #b37a41 !important;
  --name-wood-3: #865c33 !important;

  /* Wood borders */
  --wood-dark: #6b4e2e !important;
  --wood-mid:  #8a653b !important;
  --wood-lite: #b48853 !important;
  --wood-thickness: 3px !important;

  /* Pill Adjustments */
  --pill-raise: 8px !important;
  --pill-extend: 8px !important;

  /* Gradient Behind Portrait */
  --desired-alpha-value: 1;
  --gradient-lower-left: #b6e1ff;
  --gradient-upper-right: #f4f5f7;

  /* Boolean Values: 1 = YES; 0 = NO */
  --is-token-visible: 1;
  --is-token-background-offset: 0;

  /* Helpers -- Please do not change these values */
    /* Offset Helpers */
    --token-background-offset-helper: calc(
      var(--is-token-background-offset) * (
        var(--card-height) - var(--nameplate-height) - (
            var(--bar-height) * 2
        )
      )
    );
    --offset-alpha-when-offset-helper: calc(
      (1 - var(--is-token-background-offset)) 
      + (var(--is-token-background-offset) 
      * var(--desired-alpha-value))
    );
    --portrait-alpha-when-offset-helper: calc(
      ((1 - var(--is-token-background-offset)) 
      + (var(--is-token-background-offset) 
      * var(--desired-alpha-value)) * -1)
    );

    /* Gradient Helpers */
    --portrait-gradient-lower-left: rgba(from var(--gradient-lower-left) r g b / var(--portrait-alpha-when-offset-helper));
    --portrait-gradient-upper-right: rgba(from var(--gradient-upper-right) r g b / var(--portrait-alpha-when-offset-helper));
    --offset-gradient-lower-left: rgba(from var(--gradient-lower-left) r g b / var(--offset-alpha-when-offset-helper));
    --offset-gradient-upper-right: rgba(from var(--gradient-upper-right) r g b / var(--offset-alpha-when-offset-helper));    
}

/*─────────────────────────────────────────────────────────────────────────────
 1) BASE STYLES: BODY & CARD CONTAINER
─────────────────────────────────────────────────────────────────────────────*/
body {
  background-color: rgba(0, 0, 0, 0);
  margin: 0 auto;
  overflow: hidden;
  position: relative;
}

body::before{
  content: "";
  position: fixed;
  left: calc(var(--is-token-background-offset) * 340px);
  right: 0;
  top: 0;
  height: calc(
    var(--is-token-background-offset) * 
    var(--token-background-offset-helper)
  );
  width: var(--card-width);
  transform: translateY(
    calc(var(--is-token-background-offset) *
      calc(
        var(--cards-top) 
        + var(--card-height) 
        + var(--gradient-gap)
      )
    )
  );
  background: linear-gradient(
    to top right,
    var(--offset-gradient-lower-left),
    var(--offset-gradient-upper-right)
  );
  pointer-events: none;
}

.actor {
  position: absolute;
  width: var(--card-width) !important;
  height: var(--card-height) !important;
  border-radius: var(--radius-card) !important;
  overflow: hidden !important;
  box-sizing: border-box;
}

.actor:nth-child(1) { left: var(--initial-card-left-placement);}
.actor:nth-child(2) { left: calc(var(--initial-card-left-placement) + var(--card-placement-offset));}
.actor:nth-child(3) { left: calc(var(--initial-card-left-placement) + (var(--card-placement-offset) * 2));}
.actor:nth-child(4) { left: calc(var(--initial-card-left-placement) + (var(--card-placement-offset) * 3));}
.actor:nth-child(5) { left: calc(var(--initial-card-left-placement) + (var(--card-placement-offset) * 4));}

/*─────────────────────────────────────────────────────────────────────────────
 2) OVERLAY RESET
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay {
  margin: 0 !important;
  width: auto !important;
  box-sizing: border-box;
}

/*─────────────────────────────────────────────────────────────────────────────
 4) OVERLAY #1 — CHARACTER NAME (knotty wood plaque, "engraved" text)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(1) {
  position: absolute !important;
  margin: auto;
  top: 0 !important;
  width: 100% !important;
  display: flex !important;
  justify-content: center;
  align-items: center !important;
  gap: 4px !important;
  padding: 4px 6px !important;
  background-color: transparent !important;
  isolation: isolate;
}

.actor .single-line-overlay:nth-child(1)::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius: var(--radius-card) var(--radius-card) 0 0;
  /* LAYER ORDER: (top) sheen → knots → grain stripes (bottom) */
  background:
    /* subtle sheen */
    linear-gradient(180deg, rgba(255,255,255,.10) 0%, rgba(0,0,0,.18) 80%),
    /* knots */
    repeating-radial-gradient(ellipse at 22% 65%, rgba(0,0,0,.22) 0 2px, rgba(0,0,0,0) 2px 7px),
    repeating-radial-gradient(ellipse at 68% 45%, rgba(0,0,0,.20) 0 2px, rgba(0,0,0,0) 2px 7px),
    repeating-radial-gradient(ellipse at 85% 78%, rgba(0,0,0,.18) 0 2px, rgba(0,0,0,0) 2px 7px),
    /* base striped grain */
    repeating-linear-gradient(12deg,
      var(--name-wood-1) 0 8px,
      var(--name-wood-2) 8px 16px,
      var(--name-wood-3) 16px 24px);
  background-blend-mode: overlay, multiply, multiply, multiply, normal;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.35), inset 0 -2px 0 rgba(0,0,0,.25);
  pointer-events:none;
}

/* "Engraved" text styling */
.actor .single-line-overlay:nth-child(1),
.actor .single-line-overlay:nth-child(1) .component{
  font-family: var(--nameplate-font-family) !important;
  font-weight: var(--nameplate-font-weight) !important;
  font-size: var(--nameplate-text-size);
  color: var(--nameplate-font-color) !important;
  letter-spacing: .3px;
  position: relative;
  text-shadow: -1px -1px 0 rgba(0,0,0,.45), 1px 1px 0 rgba(255,255,255,.35);
  -webkit-text-stroke: 2px rgba(0,0,0,.28);
}

/*─────────────────────────────────────────────────────────────────────────────
 3) OVERLAY #2 — PORTRAIT IMAGE (below the name bar)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(2) {
  position: absolute !important;
  top: var(--nameplate-height) !important;
  left: 0; right: 0;
  bottom: calc(var(--bar-height) * 2) !important;
  background-size: cover !important;
  background-position: center !important;
  background: linear-gradient(
    to top right,
    var(--portrait-gradient-lower-left),
    var(--portrait-gradient-upper-right)
  );
  opacity: calc(var(--is-token-visible));
  padding: 0 !important;
}

/*─────────────────────────────────────────────────────────────────────────────
 5) OVERLAY #3 — HIT POINTS (pill, with foot; wood frame on 3 sides)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(3) {
  position: absolute !important;
  bottom: calc(var(--stack-height) * 3) !important;
  left: var(--inset-x) !important;
  display: flex !important;
  flex-direction: row !important; 
  align-items: center !important;
  gap: 4px !important;
  padding: 2px 4px !important;
  background-color: var(--card-bg) !important;
  font-size: var(--pill-text-size) !important;
  color: var(--hp-font-color);
  border-radius: 6px 6px 0px 0px !important;
  width: max-content !important;
  white-space: nowrap !important;
}

.actor .single-line-overlay:nth-child(3)::before{
  content: "";
  position: absolute;
  left: 0; right: 0;
  bottom: calc(-1 * var(--pill-extend));
  height: var(--pill-extend);
  background: var(--card-bg);
  pointer-events: none;
}

.actor .single-line-overlay:nth-child(3) .component {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  padding: 0 !important;
  white-space: nowrap !important;
}

.actor .single-line-overlay:nth-child(3)::after{
  content:"";
  position:absolute;
  top:  calc(-1 * var(--wood-thickness));
  left: calc(-1 * var(--wood-thickness));
  right:calc(-1 * var(--wood-thickness));
  bottom:calc(-1 * var(--wood-thickness));
  border-style: solid;
  border-width: var(--wood-thickness) var(--wood-thickness) 0 var(--wood-thickness);
  border-color: var(--wood-mid);
  border-radius: 8px 8px 0 0;
  pointer-events:none;
}

/*─────────────────────────────────────────────────────────────────────────────
 6) OVERLAY #4 — ARMOUR CLASS (pill, with foot; wood frame on 3 sides)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(4) {
  position: absolute !important;
  bottom: calc(var(--stack-height) * 3) !important;
  right: var(--inset-x) !important;
  display: flex !important;
  flex-direction: row !important;
  align-items: center !important;
  gap: 5px !important;
  padding: 4px 6px !important;
  background-color: var(--card-bg) !important;
  font-size: var(--pill-text-size) !important;
  color: var(--ac-font-color);
  border-radius: 6px 6px 0px 0px  !important;
  width: max-content !important;
  white-space: nowrap !important;
  overflow: visible !important;
}

.actor .single-line-overlay:nth-child(4)::before{
  content: "";
  position: absolute;
  left: 0; right: 0;
  bottom: calc(-1 * var(--pill-extend));
  height: var(--pill-extend);
  background: var(--card-bg);
  pointer-events: none;
}

.actor .single-line-overlay:nth-child(4) .component {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  padding: 0 !important;
  white-space: nowrap !important;
}

.actor .single-line-overlay:nth-child(4)::after{
  content:"";
  position:absolute;
  top:  calc(-1 * var(--wood-thickness));
  left: calc(-1 * var(--wood-thickness));
  right:calc(-1 * var(--wood-thickness));
  bottom:calc(-1 * var(--wood-thickness));
  border-style: solid;
  border-width: var(--wood-thickness) var(--wood-thickness) 0 var(--wood-thickness);
  border-color: var(--wood-mid);
  border-radius: 8px 8px 0 0;
  pointer-events:none;
}

/*─────────────────────────────────────────────────────────────────────────────
7) OVERLAY #5 — PHYSICAL ABILITIES (STR/DEX/CON) + wood top cap
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(5) {
  position: absolute !important;
  bottom: calc(var(--bar-height) + var(--pill-raise)) !important;
  left: 0 !important;
  width: 100% !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 4px 6px !important;
  background-color: var(--card-bg) !important;
  font-size: var(--stat-text-size);
  color: var(--physical-stats-font-color);
  box-sizing: border-box;
}

.actor .single-line-overlay:nth-child(5) .component { 
  white-space: nowrap !important; 
  margin-right: 8px !important; 
}
  
.actor .single-line-overlay:nth-child(5)::after{
  content:"";
  position:absolute;
  left: calc(-1 * var(--wood-thickness));
  right: calc(-1 * var(--wood-thickness));
  top: calc(-1 * var(--wood-thickness));
  height: calc(var(--wood-thickness) * 2);
  background: linear-gradient(90deg, var(--wood-dark), var(--wood-mid) 40%, var(--wood-lite) 60%, var(--wood-dark));
  border-radius: 6px 6px 0 0;
  pointer-events:none;
}

/*─────────────────────────────────────────────────────────────────────────────
 8) OVERLAY #6 — MENTAL ABILITIES (INT/WIS/CHA)
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(6) {
  position: absolute !important;
  bottom: 0 !important;
  left: 0 !important;
  width: 100% !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 4px 6px !important;
  background-color: var(--card-bg) !important;
  font-size: var(--stat-text-size);
  color: var(--mental-stats-font-color);
  box-sizing: border-box;
}
.actor .single-line-overlay:nth-child(6) .component { 
  white-space: nowrap !important;
  margin-right: 8px !important; 
}

/*─────────────────────────────────────────────────────────────────────────────
 9) HIDE ANY EXTRA OVERLAYS
─────────────────────────────────────────────────────────────────────────────*/
.actor .single-line-overlay:nth-child(n+8) { display: none !important; }

/*─────────────────────────────────────────────────────────────────────────────
 10) STACKING CONTEXT
─────────────────────────────────────────────────────────────────────────────*/
/* Nameplate */
.actor .single-line-overlay:nth-child(1) { z-index: 9999 !important; }

/* Token Portrait and Background Psuedo-elements */
.actor .single-line-overlay:nth-child(1)::before,
.actor .single-line-overlay:nth-child(2) .component, 
.actor .single-line-overlay:nth-child(2) .component img,
.actor .single-line-overlay:nth-child(3)::before,
.actor .single-line-overlay:nth-child(4)::before { z-index: 0 !important; }

/* Token Portrait and Foreground Psuedo-elements */
.actor,
.actor .single-line-overlay:nth-child(1), 
.actor .single-line-overlay:nth-child(1) .component,
.actor .single-line-overlay:nth-child(2),
.actor .single-line-overlay:nth-child(3)::after,
.actor .single-line-overlay:nth-child(4)::after,
.actor .single-line-overlay:nth-child(5)::after { z-index: 1 !important;}

/* Stat Block */
.actor .single-line-overlay:nth-child(5),
.actor .single-line-overlay:nth-child(6) { z-index: 2 !important; }

/* HP and AC Pills */
.actor .single-line-overlay:nth-child(3),
.actor .single-line-overlay:nth-child(4) { z-index: 3 !important; }

/* Exploded Gradient */
body::before{ z-index: 5 !important; }